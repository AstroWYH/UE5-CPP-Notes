不仅仅是姓名板，**同屏角色（玩家/NPC/怪物）本身的优化**在 MMO 里更是大头。因为：

* 每个角色都有骨骼、动画、蓝图逻辑、AI、技能特效、碰撞体积等等。
* 同屏几十上百个角色，CPU（逻辑+动画+AI）和 GPU（渲染+特效）都会爆炸。

---

## 🔹 1. 数量层面的优化（裁剪 / 限制）

**核心原则：不可能所有角色同屏都完整模拟**，要做裁剪。

* **距离裁剪**

  * 一定距离外的 NPC/玩家，不更新动画，只保持 Idle pose。
  * 怪物远距离时，甚至直接销毁/停用（Spawn Manager 管理）。

* **屏幕裁剪**

  * 不在摄像机 FOV 内的角色 → 逻辑照跑（必要时），渲染剔除。

* **优先级更新**

  * 只对「和玩家交互过的/队伍成员/战斗中的」角色保留完整逻辑。
  * 路人优先级低，可以只保留简化版。

* **最大数量限制**

  * 例如同屏最多显示 50 个角色 → 超出的只用 Billboard / Icon 替代。
  * 大型 MMO 常见：城镇几百人 → 只保留最近几十个有全套模型，其余替换成「低模影子」或者干脆不显示。

---

## 🔹 2. 表现层面的优化（LOD / Instance）

* **模型 LOD**

  * 近 → 高模带贴图；远 → 中模；很远 → 只有卡通小人/影子。
  * UE 支持 `SkeletalMesh LOD` 自动切换。

* **动画 LOD**

  * UE 有 `Animation Budget Allocator` 和 `UpdateRateOptimization`：

    * 远处角色动画更新频率降低（甚至 1 秒更新一次）。
    * 特别远的直接冻结在当前姿势。

* **材质/贴图优化**

  * 用 Instanced Material，减少材质实例数量。
  * 批量角色共享 Material Instance 参数，不要每个角色一份。

* **蒙皮优化**

  * UE5 有 `GPU Skinning`，一定要开。
  * 或者远距离角色 → 改为 baked pose（简单网格）。

---

## 🔹 3. 逻辑层面的优化（AI / Tick / 网络）

* **AI LOD**

  * 远处 NPC 不跑完整 AI，只保留 Idle 或 Patrol。
  * 战斗 AI 只在进入「感知范围」后才激活。

* **Tick 优化**

  * 角色蓝图尽量避免 Tick → 改用事件驱动。
  * 用 `SetActorTickInterval` 增大间隔，远处角色可以几百毫秒更新一次。

* **网络优化**

  * Relevancy（相关性裁剪）：UE 的 `NetCullDistanceSquared` 控制远处 Actor 不同步。
  * 大型 MMO 通常有 **Interest Management** 系统：只同步玩家附近的数据。

---

## 🔹 4. 特效 / UI 优化

* **技能特效 LOD**

  * 近距离保留全效果；远距离只保留简化版（少粒子/少光效）。
  * 批量玩家技能 → 合并光效 / 限制同屏数量。

* **姓名板/血条 LOD**（前面说过）

  * 屏幕上只允许显示有限数量，其他隐藏/简化。

---

## 🔹 5. 工程实践（MMO 常用手段）

* **人多的场景 → 分层显示**

  * 近处：正常角色。
  * 远处：影子（小黑 silhouette）或者 Billboard。
  * 超远：只显示 minimap 点，不渲染实体。

* **动态负载均衡**

  * UE 有 `WorldPartition` 可以只加载周围区域的 Actor。
  * MMO 里常有「分片显示」：同一个城镇几百人 → 客户端只展示一部分。

* **服务器下发裁剪指令**

  * 客户端自己裁剪不够，服务器也会决定：你只能看到 80 个玩家。
  * 节省带宽 + 客户端压力。

---

✅ **综合下来**

* 客户端：LOD（模型/动画/特效/姓名板）+ Tick 优化 + 渲染裁剪。
* 服务器：Interest Management（只同步相关玩家/NPC）。
* 体验：近处完整体验，远处逐级简化。

---
