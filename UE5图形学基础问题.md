这些是图形学/渲染管线里面试常问的“基础必答题”。

---

## 1️⃣ 齐次坐标为什么要用 4D 表示 3D 点？

**原因**：为了能把**平移、旋转、缩放、透视投影**都统一成矩阵乘法。

* 在 3D 里，旋转和缩放都可以用 3×3 矩阵表示，但**平移没法用纯 3×3 矩阵**。
* 加上一个额外维度 w：

  * 点：`(x, y, z, 1)`
  * 方向：`(x, y, z, 0)`（w=0 → 不受平移影响）
* 这样平移就可以写成一个 4×4 矩阵：

```
[x']   [R T][x]
[y'] = [   ][y]
[z']   [   ][z]
[w']   [0 1][1]
```

👉 **面试答法**：
“用 4D 齐次坐标是为了把平移和投影统一到矩阵乘法中，保证所有变换能链式组合（乘在一起）。”

---

## 2️⃣ 屏幕空间坐标转换过程

这是渲染管线最基本的流程，能说清楚很加分：

1. **模型空间 (Model Space)**
   顶点最初的位置，相对于模型自身的局部坐标。

2. **世界空间 (World Space)**
   乘以模型矩阵（Model Matrix），把顶点放到世界坐标里。

3. **视图空间 (View Space)**
   乘以相机的 View 矩阵（通常是相机的逆变换），把世界坐标变换到相机为原点的坐标系。

4. **裁剪空间 (Clip Space)**
   乘以投影矩阵（透视或正交）。得到 `(x, y, z, w)`，此时还没除以 w。

   * 此阶段的坐标会被裁剪（x,y,z 和 w 的范围判断）。

5. **NDC (Normalized Device Coordinates)**
   做透视除法 `(x/w, y/w, z/w)`，坐标范围标准化到 \[-1,1]。

6. **屏幕空间 (Screen Space)**
   把 NDC 映射到屏幕像素坐标 `(sx, sy)`，深度值映射到 \[0,1] 存入深度缓冲。

👉 面试说法：
“顶点依次经过模型、世界、视图、投影矩阵，得到裁剪空间 → 除以 w 得到 NDC → 映射到屏幕像素坐标。”

---

## 3️⃣ 裁剪空间 和 NDC 的区别

* **裁剪空间 (Clip Space)**：顶点乘投影矩阵后的结果 `(x, y, z, w)`，此时还没除以 w。
  → 用来做裁剪（比如判断 `-w <= x <= w`）。
* **NDC (Normalized Device Coordinates)**：做了透视除法 `(x/w, y/w, z/w)` 后的坐标，范围在 \[-1,1] 之间。

👉 面试简答：
“裁剪空间是投影矩阵输出的结果，用 w 做裁剪；NDC 是裁剪后做透视除法归一化后的坐标，范围固定在 \[-1,1]。”

---

## 4️⃣ 深度缓冲（Z-buffer）

**工作原理：**

* 每个像素存一个深度值（初始是最远）。
* 当渲染一个新片元时，拿它的深度和缓冲里的值比较：

  * 更小（更近） → 更新像素颜色和深度。
  * 更大（更远） → 丢弃。

**Z-fighting 的原因：**

* 两个表面深度非常接近时，受浮点精度限制，Z-buffer 不能分辨谁近谁远。
* 结果：一会儿画前面，一会儿画后面 → 画面抖动。

👉 面试答法：
“Z-buffer 记录像素深度来决定前后。Z-fighting 是因为两个面深度值太接近，超出深度精度能区分的范围。”

---

## 5️⃣ 透视除法（w 分量的意义）

**核心：**

* 投影矩阵得到的是 `(x, y, z, w)`。
* 除以 w 之后 `(x/w, y/w, z/w)`，才能把透视效果表现出来。

**为什么有透视感？**

* 远处的物体 w 值大 → 除以 w 后 x,y 变小 → 看起来更近于中心。
* 近处的物体 w 值小 → 除以 w 后 x,y 保持大 → 看起来更大。

👉 面试简答：
“w 分量承载透视信息，透视除法让远处的物体缩小，近处的物体放大，实现透视投影。”

---

## 6️⃣ 法线变换为什么用逆转置矩阵

**问题：**
顶点坐标用模型矩阵 M 变换。但如果直接用 M 变换法线，会出错，尤其当有**非等比缩放**时，法线可能不再垂直于表面。

**解决：**

* 法线应当用 `M⁻¹ᵀ`（逆转置矩阵）来变换，保证法线方向和表面保持垂直关系。

**例子：**

* 假设你把一个方形面在 x 方向压缩一半（缩放 0.5），如果直接用 M 去算，法线方向就歪了。
* 用逆转置矩阵，就能修正，保证法线仍然正对表面。

👉 面试简答：
“因为模型矩阵含非均匀缩放时，法线直接乘会不再垂直。用逆转置矩阵能保持法线和表面的正交性。”

---

✅ 总结速记（面试说法一套）

* 齐次坐标 4D：为了统一平移、投影变换。
* 坐标变换：模型 → 世界 → 视图 → 裁剪 → NDC → 屏幕。
* 裁剪 vs NDC：裁剪空间是投影矩阵输出 (x,y,z,w)，NDC 是透视除法后的归一化 \[-1,1]。
* Z-buffer：保存最小深度判前后，Z-fighting = 精度不足。
* 透视除法：除以 w 体现远小近大的透视效果。
* 法线逆转置：保证法线在非等比缩放下仍然正交。

---


